/**
 * Minified by jsDelivr using UglifyJS v3.4.4.
 * Original file: /npm/minio@7.0.1/dist/main/minio.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function o(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,r,t){return r&&o(e.prototype,r),t&&o(e,t),e}}();function _interopExportWildcard(e,r){var t=r({},e);return delete t.default,t}function _defaults(e,r){for(var t=Object.getOwnPropertyNames(r),o=0;o<t.length;o++){var i=t[o],n=Object.getOwnPropertyDescriptor(r,i);n&&n.configurable&&void 0===e[i]&&Object.defineProperty(e,i,n)}return e}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var _fs=require("fs"),_fs2=_interopRequireDefault(_fs),_crypto=require("crypto"),_crypto2=_interopRequireDefault(_crypto),_http=require("http"),_http2=_interopRequireDefault(_http),_https=require("https"),_https2=_interopRequireDefault(_https),_stream=require("stream"),_stream2=_interopRequireDefault(_stream),_blockStream2=require("block-stream2"),_blockStream22=_interopRequireDefault(_blockStream2),_xml=require("xml"),_xml2=_interopRequireDefault(_xml),_xml2js=require("xml2js"),_xml2js2=_interopRequireDefault(_xml2js),_async=require("async"),_async2=_interopRequireDefault(_async),_querystring=require("querystring"),_querystring2=_interopRequireDefault(_querystring),_mkdirp=require("mkdirp"),_mkdirp2=_interopRequireDefault(_mkdirp),_path=require("path"),_path2=_interopRequireDefault(_path),_lodash=require("lodash"),_lodash2=_interopRequireDefault(_lodash),_helpersJs=require("./helpers.js"),_signingJs=require("./signing.js"),_objectUploader=require("./object-uploader"),_objectUploader2=_interopRequireDefault(_objectUploader),_transformers=require("./transformers"),transformers=_interopRequireWildcard(_transformers),_errorsJs=require("./errors.js"),errors=_interopRequireWildcard(_errorsJs),_s3EndpointsJs=require("./s3-endpoints.js"),_notification=require("./notification"),Package=require("../../package.json"),Client=function(){function s(e){if(_classCallCheck(this,s),void 0!==e.secure)throw new Error('"secure" option deprecated, "useSSL" should be used instead');if(void 0===e.useSSL&&(e.useSSL=!0),e.port||(e.port=0),!(0,_helpersJs.isValidEndpoint)(e.endPoint))throw new errors.InvalidEndpointError("Invalid endPoint : "+e.endPoint);if(!(0,_helpersJs.isValidPort)(e.port))throw new errors.InvalidArgumentError("Invalid port : "+e.port);if(!(0,_helpersJs.isBoolean)(e.useSSL))throw new errors.InvalidArgumentError("Invalid useSSL flag type : "+e.useSSL+', expected to be of type "boolean"');if(e.region&&!(0,_helpersJs.isString)(e.region))throw new errors.InvalidArgumentError("Invalid region : "+e.region);var r,t=e.endPoint.toLowerCase(),o=e.port,i="";if(!1===e.useSSL?(r=_http2.default,i="http:",0===o&&(o=80)):(r=_https2.default,i="https:",0===o&&(o=443)),e.transport){if(!(0,_helpersJs.isObject)(e.transport))throw new errors.InvalidArgumentError('Invalid transport type : ${params.transport}, expected to be type "object"');r=e.transport}var n="Minio "+("("+process.platform+"; "+process.arch+")")+" minio-js/"+Package.version;this.transport=r,this.host=t,this.port=o,this.protocol=i,this.accessKey=e.accessKey,this.secretKey=e.secretKey,this.sessionToken=e.sessionToken,this.userAgent=""+n,this.accessKey||(this.accessKey=""),this.secretKey||(this.secretKey=""),this.anonymous=!this.accessKey||!this.secretKey,this.regionMap={},e.region&&(this.region=e.region),this.minimumPartSize=5242880,this.maximumPartSize=5368709120,this.maxObjectSize=5497558138880,this.enableSHA256=!this.anonymous&&!e.useSSL,this.reqOptions={}}return _createClass(s,[{key:"setRequestOptions",value:function(e){if(!(0,_helpersJs.isObject)(e))throw new TypeError('request options should be of type "object"');this.reqOptions=_lodash2.default.pick(e,["agent","ca","cert","ciphers","clientCertEngine","crl","dhparam","ecdhCurve","honorCipherOrder","key","passphrase","pfx","rejectUnauthorized","secureOptions","secureProtocol","servername","sessionIdContext"])}},{key:"getRequestOptions",value:function(e){var r,t=e.method,o=e.region,i=e.bucketName,n=e.objectName,s=e.headers,a=e.query,u={method:t};return u.headers={},i&&(r=(0,_helpersJs.isVirtualHostStyle)(this.host,this.protocol,i)),this.port&&(u.port=this.port),u.protocol=this.protocol,n&&(n=""+(0,_helpersJs.uriResourceEscape)(n)),u.path="/",u.host=this.host,(0,_helpersJs.isAmazonEndpoint)(u.host)&&(u.host=(0,_s3EndpointsJs.getS3Endpoint)(o)),r&&!e.pathStyle?(i&&(u.host=i+"."+u.host),n&&(u.path="/"+n)):(i&&(u.path="/"+i),n&&(u.path="/"+i+"/"+n)),a&&(u.path+="?"+a),u.headers.host=u.host,("http:"===u.protocol&&80!==u.port||"https:"===u.protocol&&443!==u.port)&&(u.headers.host=u.host+":"+u.port),u.headers["user-agent"]=this.userAgent,s&&_lodash2.default.map(s,function(e,r){return u.headers[r.toLowerCase()]=e}),u=Object.assign({},this.reqOptions,u)}},{key:"setAppInfo",value:function(e,r){if(!(0,_helpersJs.isString)(e))throw new TypeError("Invalid appName: "+e);if(""===e.trim())throw new errors.InvalidArgumentError("Input appName cannot be empty.");if(!(0,_helpersJs.isString)(r))throw new TypeError("Invalid appName: "+r);if(""===r.trim())throw new errors.InvalidArgumentError("Input appVersion cannot be empty.");this.userAgent=this.userAgent+" "+e+"/"+r}},{key:"calculatePartSize",value:function(e){if(!(0,_helpersJs.isNumber)(e))throw new TypeError('size should be of type "number"');if(e>this.maxObjectSize)throw new TypeError("size should not be more than "+this.maxObjectSize);var r=Math.ceil(e/1e4);return r=Math.ceil(r/this.minimumPartSize)*this.minimumPartSize}},{key:"logHTTP",value:function(e,r,t){var o=this;if(this.logStream){if(!(0,_helpersJs.isObject)(e))throw new TypeError('reqOptions should be of type "object"');if(r&&!(0,_helpersJs.isReadableStream)(r))throw new TypeError('response should be of type "Stream"');if(t&&!(t instanceof Error))throw new TypeError('err should be of type "Error"');var i=function(e){_lodash2.default.forEach(e,function(e,r){if("authorization"==r){var t=new RegExp("Signature=([0-9a-f]+)");e=e.replace(t,"Signature=**REDACTED**")}o.logStream.write(r+": "+e+"\n")}),o.logStream.write("\n")};if(this.logStream.write("REQUEST: "+e.method+" "+e.path+"\n"),i(e.headers),r&&(this.logStream.write("RESPONSE: "+r.statusCode+"\n"),i(r.headers)),t){this.logStream.write("ERROR BODY:\n");var n=JSON.stringify(t,null,"\t");this.logStream.write(n+"\n")}}}},{key:"traceOn",value:function(e){e||(e=process.stdout),this.logStream=e}},{key:"traceOff",value:function(){this.logStream=null}},{key:"makeRequest",value:function(e,r,t,o,i,n){if(!(0,_helpersJs.isObject)(e))throw new TypeError('options should be of type "object"');if(!(0,_helpersJs.isString)(r)&&!(0,_helpersJs.isObject)(r))throw new TypeError('payload should be of type "string" or "Buffer"');if(!(0,_helpersJs.isNumber)(t))throw new TypeError('statusCode should be of type "number"');if(!(0,_helpersJs.isString)(o))throw new TypeError('region should be of type "string"');if(!(0,_helpersJs.isBoolean)(i))throw new TypeError('returnResponse should be of type "boolean"');if(!(0,_helpersJs.isFunction)(n))throw new TypeError('callback should be of type "function"');e.headers||(e.headers={}),"POST"!==e.method&&"PUT"!==e.method&&"DELETE"!==e.method||(e.headers["content-length"]=r.length);var s="";this.enableSHA256&&(s=_crypto2.default.createHash("sha256").update(r).digest("hex"));var a=(0,_helpersJs.readableStream)(r);this.makeRequestStream(e,a,s,t,o,i,n)}},{key:"makeRequestStream",value:function(s,a,u,l,e,p,c){var h=this;if(!(0,_helpersJs.isObject)(s))throw new TypeError('options should be of type "object"');if(!(0,_helpersJs.isReadableStream)(a))throw new errors.InvalidArgumentError("stream should be a readable Stream");if(!(0,_helpersJs.isString)(u))throw new TypeError('sha256sum should be of type "string"');if(!(0,_helpersJs.isNumber)(l))throw new TypeError('statusCode should be of type "number"');if(!(0,_helpersJs.isString)(e))throw new TypeError('region should be of type "string"');if(!(0,_helpersJs.isBoolean)(p))throw new TypeError('returnResponse should be of type "boolean"');if(!(0,_helpersJs.isFunction)(c))throw new TypeError('callback should be of type "function"');if(!this.enableSHA256&&0!==u.length)throw new errors.InvalidArgumentError("sha256sum expected to be empty for anonymous or https requests");if(this.enableSHA256&&64!==u.length)throw new errors.InvalidArgumentError("Invalid sha256sum : "+u);var r=function(e,r){if(e)return c(e);s.region=r;var t=h.getRequestOptions(s);if(!h.anonymous){h.enableSHA256||(u="UNSIGNED-PAYLOAD");var o=new Date;t.headers["x-amz-date"]=(0,_helpersJs.makeDateLong)(o),t.headers["x-amz-content-sha256"]=u,h.sessionToken&&(t.headers["x-amz-security-token"]=h.sessionToken);var i=(0,_signingJs.signV4)(t,h.accessKey,h.secretKey,r,o);t.headers.authorization=i}var n=h.transport.request(t,function(r){if(l===r.statusCode){if(h.logHTTP(t,r),p)return c(null,r);r.on("data",function(){}),c(null)}else{delete h.regionMap[s.bucketName];var e=transformers.getErrorTransformer(r);(0,_helpersJs.pipesetup)(r,e).on("error",function(e){h.logHTTP(t,r,e),c(e)})}});(0,_helpersJs.pipesetup)(a,n).on("error",function(e){h.logHTTP(t,null,e),c(e)})};if(e)return r(null,e);this.getBucketRegion(s.bucketName,r)}},{key:"getBucketRegion",value:function(o,i){var n=this;if(!(0,_helpersJs.isValidBucketName)(o))throw new errors.InvalidBucketNameError("Invalid bucket name : "+o);if(!(0,_helpersJs.isFunction)(i))throw new TypeError('cb should be of type "function"');if(this.region)return i(null,this.region);if(this.regionMap[o])return i(null,this.regionMap[o]);var s=function(e){var r=transformers.getBucketRegionTransformer(),t="us-east-1";(0,_helpersJs.pipesetup)(e,r).on("error",i).on("data",function(e){e&&(t=e)}).on("end",function(){n.regionMap[o]=t,i(null,t)})},a="location",e="undefined"==typeof window;this.makeRequest({method:"GET",bucketName:o,query:a,pathStyle:e},"",200,"us-east-1",!0,function(e,r){if(e){if("AuthorizationHeaderMalformed"===e.name){var t=e.Region;return t?void n.makeRequest({method:"GET",bucketName:o,query:a},"",200,t,!0,function(e,r){if(e)return i(e);s(r)}):i(e)}return i(e)}s(r)})}},{key:"makeBucket",value:function(e,r,t){if(!(0,_helpersJs.isValidBucketName)(e))throw new errors.InvalidBucketNameError("Invalid bucket name: "+e);if((0,_helpersJs.isFunction)(r)&&(t=r,r=""),!(0,_helpersJs.isString)(r))throw new TypeError('region should be of type "string"');if(!(0,_helpersJs.isFunction)(t))throw new TypeError('callback should be of type "function"');var o="";if(r&&this.region&&r!==this.region)throw new errors.InvalidArgumentError("Configured region "+this.region+", requested "+r);if(r&&"us-east-1"!==r){var i=[];i.push({_attr:{xmlns:"http://s3.amazonaws.com/doc/2006-03-01/"}}),i.push({LocationConstraint:r});var n={CreateBucketConfiguration:i};o=(0,_xml2.default)(n)}r||(r="us-east-1"),this.makeRequest({method:"PUT",bucketName:e,headers:{}},o,200,r,!1,t)}},{key:"listBuckets",value:function(i){if(!(0,_helpersJs.isFunction)(i))throw new TypeError('callback should be of type "function"');this.makeRequest({method:"GET"},"",200,"us-east-1",!0,function(e,r){if(e)return i(e);var t,o=transformers.getListBucketTransformer();(0,_helpersJs.pipesetup)(r,o).on("data",function(e){return t=e}).on("error",function(e){return i(e)}).on("end",function(){return i(null,t)})})}},{key:"listIncompleteUploads",value:function(e,r,t){var i=this;if(void 0===r&&(r=""),void 0===t&&(t=!1),!(0,_helpersJs.isValidBucketName)(e))throw new errors.InvalidBucketNameError("Invalid bucket name: "+e);if(!(0,_helpersJs.isValidPrefix)(r))throw new errors.InvalidPrefixError("Invalid prefix : "+r);if(!(0,_helpersJs.isBoolean)(t))throw new TypeError('recursive should be of type "boolean"');var o=t?"":"/",n="",s="",a=[],u=!1,l=_stream2.default.Readable({objectMode:!0});return l._read=function(){return a.length?l.push(a.shift()):u?l.push(null):void i.listIncompleteUploadsQuery(e,r,n,s,o).on("error",function(e){return l.emit("error",e)}).on("data",function(r){r.prefixes.forEach(function(e){return a.push(e)}),_async2.default.eachSeries(r.uploads,function(t,o){i.listParts(e,t.key,t.uploadId,function(e,r){if(e)return o(e);t.size=r.reduce(function(e,r){return e+r.size},0),a.push(t),o()})},function(e){e?l.emit("error",e):(r.isTruncated?(n=r.nextKeyMarker,s=r.nextUploadIdMarker):u=!0,l._read())})})},l}},{key:"bucketExists",value:function(e,r){if(!(0,_helpersJs.isValidBucketName)(e))throw new errors.InvalidBucketNameError("Invalid bucket name: "+e);if(!(0,_helpersJs.isFunction)(r))throw new TypeError('callback should be of type "function"');this.makeRequest({method:"HEAD",bucketName:e},"",200,"",!1,function(e){if(e)return"NoSuchBucket"==e.code||"NotFound"==e.code?r(null,!1):r(e);r(null,!0)})}},{key:"removeBucket",value:function(r,t){var o=this;if(!(0,_helpersJs.isValidBucketName)(r))throw new errors.InvalidBucketNameError("Invalid bucket name: "+r);if(!(0,_helpersJs.isFunction)(t))throw new TypeError('callback should be of type "function"');this.makeRequest({method:"DELETE",bucketName:r},"",204,"",!1,function(e){e||delete o.regionMap[r],t(e)})}},{key:"removeIncompleteUpload",value:function(o,i,e){var n,s=this;if(!(0,_helpersJs.isValidBucketName)(o))throw new errors.isValidBucketNameError("Invalid bucket name: "+o);if(!(0,_helpersJs.isValidObjectName)(i))throw new errors.InvalidObjectNameError("Invalid object name: "+i);if(!(0,_helpersJs.isFunction)(e))throw new TypeError('callback should be of type "function"');_async2.default.during(function(t){s.findUploadId(o,i,function(e,r){if(e)return t(e);t(null,n=r)})},function(r){var e="uploadId="+n;s.makeRequest({method:"DELETE",bucketName:o,objectName:i,query:e},"",204,"",!1,function(e){return r(e)})},e)}},{key:"fGetObject",value:function(i,n,t,r){var s,a,u,l=this;if(!(0,_helpersJs.isValidBucketName)(i))throw new errors.InvalidBucketNameError("Invalid bucket name: "+i);if(!(0,_helpersJs.isValidObjectName)(n))throw new errors.InvalidObjectNameError("Invalid object name: "+n);if(!(0,_helpersJs.isString)(t))throw new TypeError('filePath should be of type "string"');if(!(0,_helpersJs.isFunction)(r))throw new TypeError('callback should be of type "function"');var p=function(e){if(e)return r(e);_fs2.default.rename(s,t,r)};_async2.default.waterfall([function(e){return l.statObject(i,n,e)},function(e,r){u=e,(0,_mkdirp2.default)(_path2.default.dirname(t),r)},function(e,o){s=t+"."+u.etag+".part.minio",_fs2.default.stat(s,function(e,r){var t=0;if(e)a=_fs2.default.createWriteStream(s,{flags:"w"});else{if(u.size===r.size)return p();t=r.size,a=_fs2.default.createWriteStream(s,{flags:"a"})}l.getPartialObject(i,n,t,0,o)})},function(e,r){(0,_helpersJs.pipesetup)(e,a).on("error",function(e){return r(e)}).on("finish",r)},function(e){return _fs2.default.stat(s,e)},function(e,r){if(e.size===u.size)return r();r(new Error("Size mismatch between downloaded file and the object"))}],p)}},{key:"getObject",value:function(e,r,t){if(!(0,_helpersJs.isValidBucketName)(e))throw new errors.InvalidBucketNameError("Invalid bucket name: "+e);if(!(0,_helpersJs.isValidObjectName)(r))throw new errors.InvalidObjectNameError("Invalid object name: "+r);if(!(0,_helpersJs.isFunction)(t))throw new TypeError('callback should be of type "function"');this.getPartialObject(e,r,0,0,t)}},{key:"getPartialObject",value:function(e,r,t,o,i){if((0,_helpersJs.isFunction)(o)&&(i=o,o=0),!(0,_helpersJs.isValidBucketName)(e))throw new errors.InvalidBucketNameError("Invalid bucket name: "+e);if(!(0,_helpersJs.isValidObjectName)(r))throw new errors.InvalidObjectNameError("Invalid object name: "+r);if(!(0,_helpersJs.isNumber)(t))throw new TypeError('offset should be of type "number"');if(!(0,_helpersJs.isNumber)(o))throw new TypeError('length should be of type "number"');if(!(0,_helpersJs.isFunction)(i))throw new TypeError('callback should be of type "function"');var n="";(t||o)&&(t?n="bytes="+ +t+"-":(n="bytes=0-",t=0),o&&(n+=""+(+o+t-1)));var s={};""!==n&&(s.range=n);var a=200;n&&(a=206);this.makeRequest({method:"GET",bucketName:e,objectName:r,headers:s},"",a,"",!0,i)}},{key:"fPutObject",value:function(h,f,d,m,a){var y,b,w=this;if(!(0,_helpersJs.isValidBucketName)(h))throw new errors.InvalidBucketNameError("Invalid bucket name: "+h);if(!(0,_helpersJs.isValidObjectName)(f))throw new errors.InvalidObjectNameError("Invalid object name: "+f);if(!(0,_helpersJs.isString)(d))throw new TypeError('filePath should be of type "string"');if((0,_helpersJs.isFunction)(m)&&(a=m,m={}),!(0,_helpersJs.isObject)(m))throw new TypeError('metaData should be of type "object"');m=(0,_helpersJs.prependXAMZMeta)(m),_async2.default.waterfall([function(e){return _fs2.default.stat(d,e)},function(e,i){if((y=e.size)>w.maxObjectSize)return i(new Error(d+" size : "+e.size+", max allowed size : 5TB"));if(y<w.minimumPartSize){var n=w.getUploader(h,f,m,!1),r=transformers.getHashSummer(w.enableSHA256),t=y-1;0===y&&(t=0);var s={start:0,end:t,autoClose:!0};(0,_helpersJs.pipesetup)(_fs2.default.createReadStream(d,s),r).on("data",function(e){var r=e.md5sum,t=e.sha256sum,o=_fs2.default.createReadStream(d,s);n(o,y,t,r,function(e,r){a(e,r),i(!0)})}).on("error",function(e){return i(e)})}else w.findUploadId(h,f,i)},function(t,o){if(t)return w.listParts(h,f,t,function(e,r){return o(e,t,r)});w.initiateNewMultipartUpload(h,f,m,function(e,r){return o(e,r,[])})},function(a,e,r){b=w.calculatePartSize(y);var u=w.getUploader(h,f,m,!0),t=e.reduce(function(e,r){return e[r.part]||(e[r.part]=r),e},{}),l=[],p=1,c=0;_async2.default.whilst(function(){return c<y},function(o){var i=t[p],e=transformers.getHashSummer(w.enableSHA256),n=b;y-c<n&&(n=y-c);var s={autoClose:!0,start:c,end:c+n-1};(0,_helpersJs.pipesetup)(_fs2.default.createReadStream(d,s),e).on("data",function(e){var r=new Buffer(e.md5sum,"base64").toString("hex");if(i&&r===i.etag)return l.push({part:p,etag:i.etag}),p++,c+=n,o();var t=_fs2.default.createReadStream(d,s);u(a,p,t,n,e.sha256sum,e.md5sum,function(e,r){return e?o(e):(l.push({part:p,etag:r}),p++,c+=n,o())})}).on("error",function(e){return o(e)})},function(e){if(e)return r(e);r(null,l,a)})},function(e,r,t){return w.completeMultipartUpload(h,f,r,e,t)}],function(e){for(var r=arguments.length,t=Array(1<r?r-1:0),o=1;o<r;o++)t[o-1]=arguments[o];!0!==e&&a.apply(void 0,[e].concat(t))})}},{key:"putObject",value:function(e,r,t,o,i,n){if(!(0,_helpersJs.isValidBucketName)(e))throw new errors.InvalidBucketNameError("Invalid bucket name: "+e);if(!(0,_helpersJs.isValidObjectName)(r))throw new errors.InvalidObjectNameError("Invalid object name: "+r);if((0,_helpersJs.isFunction)(o)?(n=o,i={}):(0,_helpersJs.isFunction)(i)&&(n=i,i={}),(0,_helpersJs.isObject)(o)&&(i=o),i=(0,_helpersJs.prependXAMZMeta)(i),"string"==typeof t||t instanceof Buffer)o=t.length,t=(0,_helpersJs.readableStream)(t);else if(!(0,_helpersJs.isReadableStream)(t))throw new TypeError('third argument should be of type "stream.Readable" or "Buffer" or "string"');if(!(0,_helpersJs.isFunction)(n))throw new TypeError('callback should be of type "function"');if((0,_helpersJs.isNumber)(o)&&o<0)throw new errors.InvalidArgumentError("size cannot be negative, given size: "+o);(0,_helpersJs.isNumber)(o)||(o=this.maxObjectSize),o=this.calculatePartSize(o);var s=(0,_blockStream22.default)({size:o,zeroPadding:!1}),a=new _objectUploader2.default(this,e,r,o,i,n);t.pipe(s).pipe(a)}},{key:"copyObject",value:function(e,r,t,o,i){var n,s,a=e,u=r,l=t;if("function"==typeof o&&void 0===i?(n=null,s=o):(n=o,s=i),!(0,_helpersJs.isValidBucketName)(a))throw new errors.InvalidBucketNameError("Invalid bucket name: "+a);if(!(0,_helpersJs.isValidObjectName)(u))throw new errors.InvalidObjectNameError("Invalid object name: "+u);if(!(0,_helpersJs.isString)(l))throw new TypeError('srcObject should be of type "string"');if(""===l)throw new errors.InvalidPrefixError("Empty source prefix");if(null!==n&&!(n instanceof CopyConditions))throw new TypeError('conditions should be of type "CopyConditions"');var p={};p["x-amz-copy-source"]=(0,_helpersJs.uriEscape)(l),null!==n&&(""!==n.modified&&(p["x-amz-copy-source-if-modified-since"]=n.modified),""!==n.unmodified&&(p["x-amz-copy-source-if-unmodified-since"]=n.unmodified),""!==n.matchETag&&(p["x-amz-copy-source-if-match"]=n.matchETag),""!==n.matchEtagExcept&&(p["x-amz-copy-source-if-none-match"]=n.matchETagExcept));this.makeRequest({method:"PUT",bucketName:a,objectName:u,headers:p},"",200,"",!0,function(e,r){if(e)return s(e);var t=transformers.getCopyObjectTransformer();(0,_helpersJs.pipesetup)(r,t).on("error",function(e){return s(e)}).on("data",function(e){return s(null,e)})})}},{key:"listObjectsQuery",value:function(e,r,t,o,i){if(!(0,_helpersJs.isValidBucketName)(e))throw new errors.InvalidBucketNameError("Invalid bucket name: "+e);if(!(0,_helpersJs.isString)(r))throw new TypeError('prefix should be of type "string"');if(!(0,_helpersJs.isString)(t))throw new TypeError('marker should be of type "string"');if(!(0,_helpersJs.isString)(o))throw new TypeError('delimiter should be of type "string"');if(!(0,_helpersJs.isNumber)(i))throw new TypeError('maxKeys should be of type "number"');var n=[];r&&(r=(0,_helpersJs.uriEscape)(r),n.push("prefix="+r)),t&&(t=(0,_helpersJs.uriEscape)(t),n.push("marker="+t)),o&&(o=(0,_helpersJs.uriEscape)(o),n.push("delimiter="+o)),i&&(1e3<=i&&(i=1e3),n.push("max-keys="+i)),n.sort();var s="";0<n.length&&(s=""+n.join("&"));var a=transformers.getListObjectsTransformer();return this.makeRequest({method:"GET",bucketName:e,query:s},"",200,"",!0,function(e,r){if(e)return a.emit("error",e);(0,_helpersJs.pipesetup)(r,a)}),a}},{key:"listObjects",value:function(e,r,t){var o=this;if(void 0===r&&(r=""),void 0===t&&(t=!1),!(0,_helpersJs.isValidBucketName)(e))throw new errors.InvalidBucketNameError("Invalid bucket name: "+e);if(!(0,_helpersJs.isValidPrefix)(r))throw new errors.InvalidPrefixError("Invalid prefix : "+r);if(!(0,_helpersJs.isString)(r))throw new TypeError('prefix should be of type "string"');if(!(0,_helpersJs.isBoolean)(t))throw new TypeError('recursive should be of type "boolean"');var i=t?"":"/",n="",s=[],a=!1,u=_stream2.default.Readable({objectMode:!0});return u._read=function(){if(!s.length)return a?u.push(null):void o.listObjectsQuery(e,r,n,i,1e3).on("error",function(e){return u.emit("error",e)}).on("data",function(e){e.isTruncated?n=e.nextMarker:a=!0,s=e.objects,u._read()});u.push(s.shift())},u}},{key:"listObjectsV2Query",value:function(e,r,t,o,i){if(!(0,_helpersJs.isValidBucketName)(e))throw new errors.InvalidBucketNameError("Invalid bucket name: "+e);if(!(0,_helpersJs.isString)(r))throw new TypeError('prefix should be of type "string"');if(!(0,_helpersJs.isString)(t))throw new TypeError('continuationToken should be of type "string"');if(!(0,_helpersJs.isString)(o))throw new TypeError('delimiter should be of type "string"');if(!(0,_helpersJs.isNumber)(i))throw new TypeError('maxKeys should be of type "number"');var n=[];n.push("list-type=2"),r&&(r=(0,_helpersJs.uriEscape)(r),n.push("prefix="+r)),t&&(t=(0,_helpersJs.uriEscape)(t),n.push("continuation-token="+t)),o&&(o=(0,_helpersJs.uriEscape)(o),n.push("delimiter="+o)),i&&(1e3<=i&&(i=1e3),n.push("max-keys="+i)),n.sort();var s="";0<n.length&&(s=""+n.join("&"));var a=transformers.getListObjectsV2Transformer();return this.makeRequest({method:"GET",bucketName:e,query:s},"",200,"",!0,function(e,r){if(e)return a.emit("error",e);(0,_helpersJs.pipesetup)(r,a)}),a}},{key:"listObjectsV2",value:function(e,r,t){var o=this;if(void 0===r&&(r=""),void 0===t&&(t=!1),!(0,_helpersJs.isValidBucketName)(e))throw new errors.InvalidBucketNameError("Invalid bucket name: "+e);if(!(0,_helpersJs.isValidPrefix)(r))throw new errors.InvalidPrefixError("Invalid prefix : "+r);if(!(0,_helpersJs.isString)(r))throw new TypeError('prefix should be of type "string"');if(!(0,_helpersJs.isBoolean)(t))throw new TypeError('recursive should be of type "boolean"');var i=t?"":"/",n="",s=[],a=!1,u=_stream2.default.Readable({objectMode:!0});return u._read=function(){if(!s.length)return a?u.push(null):void o.listObjectsV2Query(e,r,n,i,1e3).on("error",function(e){return u.emit("error",e)}).on("data",function(e){e.isTruncated?n=e.nextContinuationToken:a=!0,s=e.objects,u._read()});u.push(s.shift())},u}},{key:"statObject",value:function(e,r,i){if(!(0,_helpersJs.isValidBucketName)(e))throw new errors.InvalidBucketNameError("Invalid bucket name: "+e);if(!(0,_helpersJs.isValidObjectName)(r))throw new errors.InvalidObjectNameError("Invalid object name: "+r);if(!(0,_helpersJs.isFunction)(i))throw new TypeError('callback should be of type "function"');this.makeRequest({method:"HEAD",bucketName:e,objectName:r},"",200,"",!0,function(e,r){if(e)return i(e);r.on("data",function(){});var t={size:+r.headers["content-length"],metaData:(0,_helpersJs.extractMetadata)(r.headers),lastModified:new Date(r.headers["last-modified"])},o=r.headers.etag;o&&(o=o.replace(/^"/,"").replace(/"$/,""),t.etag=o),i(null,t)})}},{key:"removeObject",value:function(e,r,t){if(!(0,_helpersJs.isValidBucketName)(e))throw new errors.InvalidBucketNameError("Invalid bucket name: "+e);if(!(0,_helpersJs.isValidObjectName)(r))throw new errors.InvalidObjectNameError("Invalid object name: "+r);if(!(0,_helpersJs.isFunction)(t))throw new TypeError('callback should be of type "function"');this.makeRequest({method:"DELETE",bucketName:e,objectName:r},"",204,"",!1,t)}},{key:"removeObjects",value:function(s,e,r){var a=this;if(!(0,_helpersJs.isValidBucketName)(s))throw new errors.InvalidBucketNameError("Invalid bucket name: "+s);if(!(0,_helpersJs.isArray)(e))throw new errors.InvalidArgumentError("objectsList should be a list");if(!(0,_helpersJs.isFunction)(r))throw new TypeError('callback should be of type "function"');var t=e.reduce(function(e,r){return e.list.push(r),1e3===e.list.length&&(e.listOfList.push(e.list),e.list=[]),e},{listOfList:[],list:[]});0<t.list.length&&t.listOfList.push(t.list),_async2.default.eachSeries(t.listOfList,function(e,r){var t={Delete:[{Quiet:!0}]};e.forEach(function(e){t.Delete.push({Object:[{Key:e}]})});var o=(0,_xml2.default)(t),i={},n=_crypto2.default.createHash("md5").update(o).digest();i["Content-MD5"]=n.toString("base64"),a.makeRequest({method:"POST",bucketName:s,query:"delete",headers:i},o,200,"",!1,function(e){if(e)return r(e);r(null)})},r)}},{key:"getBucketPolicy",value:function(e,o){if(!(0,_helpersJs.isValidBucketName)(e))throw new errors.InvalidBucketNameError("Invalid bucket name: "+e);if(!(0,_helpersJs.isFunction)(o))throw new TypeError('callback should be of type "function"');this.makeRequest({method:"GET",bucketName:e,query:"policy"},"",200,"",!0,function(e,r){if(e)return o(e);var t=new Buffer("");(0,_helpersJs.pipesetup)(r,transformers.getConcater()).on("data",function(e){return t=e}).on("error",o).on("end",function(){o(null,t.toString())})})}},{key:"setBucketPolicy",value:function(e,r,t){if(!(0,_helpersJs.isValidBucketName)(e))throw new errors.InvalidBucketNameError("Invalid bucket name: "+e);if(!(0,_helpersJs.isString)(r))throw new errors.InvalidBucketPolicyError("Invalid bucket policy: "+r+' - must be "string"');if(!(0,_helpersJs.isFunction)(t))throw new TypeError('callback should be of type "function"');var o="DELETE";r&&(o="PUT"),this.makeRequest({method:o,bucketName:e,query:"policy"},r,204,"",!1,t)}},{key:"presignedUrl",value:function(i,n,s,a,e,u){var l=this;if(this.anonymous)throw new errors.AnonymousRequestError("Presigned "+i+" url cannot be generated for anonymous requests");if((0,_helpersJs.isFunction)(e)&&(u=e,e={}),(0,_helpersJs.isFunction)(a)&&(u=a,e={},a=604800),!(0,_helpersJs.isNumber)(a))throw new TypeError('expires should be of type "number"');if(!(0,_helpersJs.isObject)(e))throw new TypeError('reqParams should be of type "object"');if(!(0,_helpersJs.isFunction)(u))throw new TypeError('callback should be of type "function"');var p=new Date,c=_querystring2.default.stringify(e);this.getBucketRegion(n,function(e,r){if(e)return u(e);var t,o=l.getRequestOptions({method:i,region:r,bucketName:n,objectName:s,query:c});try{t=(0,_signingJs.presignSignatureV4)(o,l.accessKey,l.secretKey,r,p,a)}catch(e){return u(e)}u(null,t)})}},{key:"presignedGetObject",value:function(e,r,t,o,i){if(!(0,_helpersJs.isValidBucketName)(e))throw new errors.InvalidBucketNameError("Invalid bucket name: "+e);if(!(0,_helpersJs.isValidObjectName)(r))throw new errors.InvalidObjectNameError("Invalid object name: "+r);return["response-content-type","response-content-language","response-expires","response-cache-control","response-content-disposition","response-content-encoding"].forEach(function(e){if(void 0!==o&&void 0!==o[e]&&!(0,_helpersJs.isString)(o[e]))throw new TypeError("response header "+e+' should be of type "string"')}),this.presignedUrl("GET",e,r,t,o,i)}},{key:"presignedPutObject",value:function(e,r,t,o){if(!(0,_helpersJs.isValidBucketName)(e))throw new errors.InvalidBucketNameError("Invalid bucket name: ${bucketName}");if(!(0,_helpersJs.isValidObjectName)(r))throw new errors.InvalidObjectNameError("Invalid object name: ${objectName}");return this.presignedUrl("PUT",e,r,t,o)}},{key:"newPostPolicy",value:function(){return new PostPolicy}},{key:"presignedPostPolicy",value:function(c,h){var f=this;if(this.anonymous)throw new errors.AnonymousRequestError("Presigned POST policy cannot be generated for anonymous requests");if(!(0,_helpersJs.isObject)(c))throw new TypeError('postPolicy should be of type "object"');if(!(0,_helpersJs.isFunction)(h))throw new TypeError('cb should be of type "function"');this.getBucketRegion(c.formData.bucket,function(e,r){if(e)return h(e);var t=new Date,o=(0,_helpersJs.makeDateLong)(t);if(!c.policy.expiration){var i=new Date;i.setSeconds(604800),c.setExpires(i)}c.policy.conditions.push(["eq","$x-amz-date",o]),c.formData["x-amz-date"]=o,c.policy.conditions.push(["eq","$x-amz-algorithm","AWS4-HMAC-SHA256"]),c.formData["x-amz-algorithm"]="AWS4-HMAC-SHA256",c.policy.conditions.push(["eq","$x-amz-credential",f.accessKey+"/"+(0,_helpersJs.getScope)(r,t)]),c.formData["x-amz-credential"]=f.accessKey+"/"+(0,_helpersJs.getScope)(r,t);var n=new Buffer(JSON.stringify(c.policy)).toString("base64");c.formData.policy=n;var s=(0,_signingJs.postPresignSignatureV4)(r,t,f.secretKey,n);c.formData["x-amz-signature"]=s;var a={};a.region=r,a.bucketName=c.formData.bucket;var u=f.getRequestOptions(a),l=80==f.port||443===f.port?"":":"+f.port.toString(),p=u.protocol+"//"+u.host+l+u.path;h(null,{postURL:p,formData:c.formData})})}},{key:"initiateNewMultipartUpload",value:function(e,r,t,o){if(!(0,_helpersJs.isValidBucketName)(e))throw new errors.InvalidBucketNameError("Invalid bucket name: "+e);if(!(0,_helpersJs.isValidObjectName)(r))throw new errors.InvalidObjectNameError("Invalid object name: "+r);if(!(0,_helpersJs.isObject)(t))throw new errors.InvalidObjectNameError('contentType should be of type "object"');var i=Object.assign({},t);this.makeRequest({method:"POST",bucketName:e,objectName:r,query:"uploads",headers:i},"",200,"",!0,function(e,r){if(e)return o(e);var t=transformers.getInitiateMultipartTransformer();(0,_helpersJs.pipesetup)(r,t).on("error",function(e){return o(e)}).on("data",function(e){return o(null,e)})})}},{key:"completeMultipartUpload",value:function(e,r,t,o,i){if(!(0,_helpersJs.isValidBucketName)(e))throw new errors.InvalidBucketNameError("Invalid bucket name: "+e);if(!(0,_helpersJs.isValidObjectName)(r))throw new errors.InvalidObjectNameError("Invalid object name: "+r);if(!(0,_helpersJs.isString)(t))throw new TypeError('uploadId should be of type "string"');if(!(0,_helpersJs.isObject)(o))throw new TypeError('etags should be of type "Array"');if(!(0,_helpersJs.isFunction)(i))throw new TypeError('cb should be of type "function"');if(!t)throw new errors.InvalidArgumentError("uploadId cannot be empty");var n="uploadId="+(0,_helpersJs.uriEscape)(t),s=[];o.forEach(function(e){s.push({Part:[{PartNumber:e.part},{ETag:e.etag}]})});var a={CompleteMultipartUpload:s},u=(0,_xml2.default)(a);this.makeRequest({method:"POST",bucketName:e,objectName:r,query:n},u,200,"",!0,function(e,r){if(e)return i(e);var t=transformers.getCompleteMultipartTransformer();(0,_helpersJs.pipesetup)(r,t).on("error",function(e){return i(e)}).on("data",function(e){e.errCode?i(new errors.S3Error(e.errMessage)):i(null,e.etag)})})}},{key:"listParts",value:function(r,o,i,n){var s=this;if(!(0,_helpersJs.isValidBucketName)(r))throw new errors.InvalidBucketNameError("Invalid bucket name: "+r);if(!(0,_helpersJs.isValidObjectName)(o))throw new errors.InvalidObjectNameError("Invalid object name: "+o);if(!(0,_helpersJs.isString)(i))throw new TypeError('uploadId should be of type "string"');if(!i)throw new errors.InvalidArgumentError("uploadId cannot be empty");var a=[];!function t(e){s.listPartsQuery(r,o,i,e,function(e,r){e?n(e):(a=a.concat(r.parts),r.isTruncated?t(r.marker):n(null,a))})}(0)}},{key:"listPartsQuery",value:function(e,r,t,o,i){if(!(0,_helpersJs.isValidBucketName)(e))throw new errors.InvalidBucketNameError("Invalid bucket name: "+e);if(!(0,_helpersJs.isValidObjectName)(r))throw new errors.InvalidObjectNameError("Invalid object name: "+r);if(!(0,_helpersJs.isString)(t))throw new TypeError('uploadId should be of type "string"');if(!(0,_helpersJs.isNumber)(o))throw new TypeError('marker should be of type "number"');if(!(0,_helpersJs.isFunction)(i))throw new TypeError('callback should be of type "function"');if(!t)throw new errors.InvalidArgumentError("uploadId cannot be empty");var n="";o&&0!==o&&(n+="part-number-marker="+o+"&"),n+="uploadId="+(0,_helpersJs.uriEscape)(t);this.makeRequest({method:"GET",bucketName:e,objectName:r,query:n},"",200,"",!0,function(e,r){if(e)return i(e);var t=transformers.getListPartsTransformer();(0,_helpersJs.pipesetup)(r,t).on("error",function(e){return i(e)}).on("data",function(e){return i(null,e)})})}},{key:"listIncompleteUploadsQuery",value:function(e,r,t,o,i){if(!(0,_helpersJs.isValidBucketName)(e))throw new errors.InvalidBucketNameError("Invalid bucket name: "+e);if(!(0,_helpersJs.isString)(r))throw new TypeError('prefix should be of type "string"');if(!(0,_helpersJs.isString)(t))throw new TypeError('keyMarker should be of type "string"');if(!(0,_helpersJs.isString)(o))throw new TypeError('uploadIdMarker should be of type "string"');if(!(0,_helpersJs.isString)(i))throw new TypeError('delimiter should be of type "string"');var n=[];r&&n.push("prefix="+(0,_helpersJs.uriEscape)(r)),t&&(t=(0,_helpersJs.uriEscape)(t),n.push("key-marker="+t)),o&&n.push("upload-id-marker="+o),i&&n.push("delimiter="+(0,_helpersJs.uriEscape)(i));n.push("max-uploads=1000"),n.sort(),n.unshift("uploads");var s="";0<n.length&&(s=""+n.join("&"));var a=transformers.getListMultipartTransformer();return this.makeRequest({method:"GET",bucketName:e,query:s},"",200,"",!0,function(e,r){if(e)return a.emit("error",e);(0,_helpersJs.pipesetup)(r,a)}),a}},{key:"findUploadId",value:function(o,i,n){var s,a=this;if(!(0,_helpersJs.isValidBucketName)(o))throw new errors.InvalidBucketNameError("Invalid bucket name: "+o);if(!(0,_helpersJs.isValidObjectName)(i))throw new errors.InvalidObjectNameError("Invalid object name: "+i);if(!(0,_helpersJs.isFunction)(n))throw new TypeError('cb should be of type "function"');!function r(e,t){a.listIncompleteUploadsQuery(o,i,e,t,"").on("error",function(e){return n(e)}).on("data",function(e){if(e.uploads.forEach(function(e){e.key!==i||s&&!(e.initiated.getTime()>s.initiated.getTime())||(s=e)}),!e.isTruncated)return s?n(null,s.uploadId):void n(null,void 0);r(e.nextKeyMarker,e.nextUploadIdMarker)})}("","")}},{key:"getUploader",value:function(a,u,l,e){var p=this;if(!(0,_helpersJs.isValidBucketName)(a))throw new errors.InvalidBucketNameError("Invalid bucket name: "+a);if(!(0,_helpersJs.isValidObjectName)(u))throw new errors.InvalidObjectNameError("Invalid object name: "+u);if(!(0,_helpersJs.isBoolean)(e))throw new TypeError('multipart should be of type "boolean"');if(!(0,_helpersJs.isObject)(l))throw new TypeError('metadata should be of type "object"');var s=function(e,r,t,o,i){if(!(0,_helpersJs.isReadableStream)(e))throw new TypeError('stream should be of type "Stream"');if(!(0,_helpersJs.isNumber)(r))throw new TypeError('length should be of type "number"');if(!(0,_helpersJs.isString)(t))throw new TypeError('sha256sum should be of type "string"');if(!(0,_helpersJs.isString)(o))throw new TypeError('md5sum should be of type "string"');if(!(0,_helpersJs.isFunction)(i))throw new TypeError('callback should be of type "function"')},c=function(e,r,t,o,i,n){var s=Object.assign({},l,{"Content-Length":t});p.enableSHA256||(s["Content-MD5"]=i),p.makeRequestStream({method:"PUT",bucketName:a,objectName:u,query:e,headers:s},r,o,200,"",!0,function(e,r){if(e)return n(e);var t=r.headers.etag;t&&(t=t.replace(/^"/,"").replace(/"$/,"")),r.on("data",function(){}),n(null,t)})};return e?function(e,r){for(var t=arguments.length,o=Array(2<t?t-2:0),i=2;i<t;i++)o[i-2]=arguments[i];if(!(0,_helpersJs.isString)(e))throw new TypeError('uploadId should be of type "string"');if(!(0,_helpersJs.isNumber)(r))throw new TypeError('partNumber should be of type "number"');if(!e)throw new errors.InvalidArgumentError("Empty uploadId");if(!r)throw new errors.InvalidArgumentError("partNumber cannot be 0");s.apply(void 0,o);var n="partNumber="+r+"&uploadId="+(0,_helpersJs.uriEscape)(e);c.apply(void 0,[n].concat(o))}:function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];s.apply(void 0,r);c.apply(void 0,[""].concat(r))}}},{key:"setBucketNotification",value:function(e,r,t){if(!(0,_helpersJs.isValidBucketName)(e))throw new errors.InvalidBucketNameError("Invalid bucket name: "+e);if(!(0,_helpersJs.isObject)(r))throw new TypeError('notification config should be of type "Object"');if(!(0,_helpersJs.isFunction)(t))throw new TypeError('callback should be of type "function"');var o=new _xml2js2.default.Builder({rootName:"NotificationConfiguration",renderOpts:{pretty:!1},headless:!0}).buildObject(r);this.makeRequest({method:"PUT",bucketName:e,query:"notification"},o,200,"",!1,t)}},{key:"removeAllBucketNotification",value:function(e,r){this.setBucketNotification(e,new _notification.NotificationConfig,r)}},{key:"getBucketNotification",value:function(e,i){if(!(0,_helpersJs.isValidBucketName)(e))throw new errors.InvalidBucketNameError("Invalid bucket name: "+e);if(!(0,_helpersJs.isFunction)(i))throw new TypeError('callback should be of type "function"');this.makeRequest({method:"GET",bucketName:e,query:"notification"},"",200,"",!0,function(e,r){if(e)return i(e);var t,o=transformers.getBucketNotificationTransformer();(0,_helpersJs.pipesetup)(r,o).on("data",function(e){return t=e}).on("error",function(e){return i(e)}).on("end",function(){return i(null,t)})})}},{key:"listenBucketNotification",value:function(e,r,t,o){if(!(0,_helpersJs.isValidBucketName)(e))throw new errors.InvalidBucketNameError("Invalid bucket name: "+e);if(!(0,_helpersJs.isString)(r))throw new TypeError("prefix must be of type string");if(!(0,_helpersJs.isString)(t))throw new TypeError("suffix must be of type string");if(!(0,_helpersJs.isArray)(o))throw new TypeError("events must be of type Array");var i=new _notification.NotificationPoller(this,e,r,t,o);return i.start(),i}}]),s}();(exports.Client=Client).prototype.makeBucket=(0,_helpersJs.promisify)(Client.prototype.makeBucket),Client.prototype.listBuckets=(0,_helpersJs.promisify)(Client.prototype.listBuckets),Client.prototype.bucketExists=(0,_helpersJs.promisify)(Client.prototype.bucketExists),Client.prototype.removeBucket=(0,_helpersJs.promisify)(Client.prototype.removeBucket),Client.prototype.getObject=(0,_helpersJs.promisify)(Client.prototype.getObject),Client.prototype.getPartialObject=(0,_helpersJs.promisify)(Client.prototype.getPartialObject),Client.prototype.fGetObject=(0,_helpersJs.promisify)(Client.prototype.fGetObject),Client.prototype.putObject=(0,_helpersJs.promisify)(Client.prototype.putObject),Client.prototype.fPutObject=(0,_helpersJs.promisify)(Client.prototype.fPutObject),Client.prototype.copyObject=(0,_helpersJs.promisify)(Client.prototype.copyObject),Client.prototype.statObject=(0,_helpersJs.promisify)(Client.prototype.statObject),Client.prototype.removeObject=(0,_helpersJs.promisify)(Client.prototype.removeObject),Client.prototype.removeObjects=(0,_helpersJs.promisify)(Client.prototype.removeObjects),Client.prototype.presignedGetObject=(0,_helpersJs.promisify)(Client.prototype.presignedGetObject),Client.prototype.presignedPutObject=(0,_helpersJs.promisify)(Client.prototype.presignedPutObject),Client.prototype.presignedPostPolicy=(0,_helpersJs.promisify)(Client.prototype.presignedPostPolicy),Client.prototype.getBucketNotification=(0,_helpersJs.promisify)(Client.prototype.getBucketNotification),Client.prototype.setBucketNotification=(0,_helpersJs.promisify)(Client.prototype.setBucketNotification),Client.prototype.removeAllBucketNotification=(0,_helpersJs.promisify)(Client.prototype.removeAllBucketNotification),Client.prototype.getBucketPolicy=(0,_helpersJs.promisify)(Client.prototype.getBucketPolicy),Client.prototype.setBucketPolicy=(0,_helpersJs.promisify)(Client.prototype.setBucketPolicy),Client.prototype.removeIncompleteUpload=(0,_helpersJs.promisify)(Client.prototype.removeIncompleteUpload);var CopyConditions=function(){function e(){_classCallCheck(this,e),this.modified="",this.unmodified="",this.matchETag="",this.matchETagExcept=""}return _createClass(e,[{key:"setModified",value:function(e){if(!(e instanceof Date))throw new TypeError("date must be of type Date");this.modified=e.toUTCString()}},{key:"setUnmodified",value:function(e){if(!(e instanceof Date))throw new TypeError("date must be of type Date");this.unmodified=e.toUTCString()}},{key:"setMatchETag",value:function(e){this.matchETag=e}},{key:"setMatchETagExcept",value:function(e){this.matchETagExcept=e}}]),e}();exports.CopyConditions=CopyConditions;var PostPolicy=function(){function e(){_classCallCheck(this,e),this.policy={conditions:[]},this.formData={}}return _createClass(e,[{key:"setExpires",value:function(e){if(!e)throw new errors.InvalidDateError("Invalid date : cannot be null");this.policy.expiration=e.toISOString()}},{key:"setKey",value:function(e){if(!(0,_helpersJs.isValidObjectName)(e))throw new errors.InvalidObjectNameError("Invalid object name : "+e);this.policy.conditions.push(["eq","$key",e]),this.formData.key=e}},{key:"setKeyStartsWith",value:function(e){if(!(0,_helpersJs.isValidPrefix)(e))throw new errors.InvalidPrefixError("Invalid prefix : "+e);this.policy.conditions.push(["starts-with","$key",e]),this.formData.key=e}},{key:"setBucket",value:function(e){if(!(0,_helpersJs.isValidBucketName)(e))throw new errors.InvalidBucketNameError("Invalid bucket name : "+e);this.policy.conditions.push(["eq","$bucket",e]),this.formData.bucket=e}},{key:"setContentType",value:function(e){if(!e)throw new Error("content-type cannot be null");this.policy.conditions.push(["eq","$Content-Type",e]),this.formData["Content-Type"]=e}},{key:"setContentLengthRange",value:function(e,r){if(r<e)throw new Error("min cannot be more than max");if(e<0)throw new Error("min should be > 0");if(r<0)throw new Error("max should be > 0");this.policy.conditions.push(["content-length-range",e,r])}}]),e}();exports.PostPolicy=PostPolicy,_defaults(exports,_interopExportWildcard(_notification,_defaults));
//# sourceMappingURL=/sm/96106e2a38ed4ffe071b8c16835ac4983ea77bfbfc1cb7e48f622021c3471aee.map